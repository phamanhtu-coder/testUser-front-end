function showAngularJsModalByBtn(n){var i=$(n).attr("data-modal-tpl"),r=$(n).attr("data-modal-qs"),u="/HtmlTemplate?name="+i,t=$(n).attr("data-modal-title");(t==undefined||t=="")&&(t=$(n).html());showAngularJsModal(i,r,t,$(n).attr("login-required"))}function showAngularJsModal(n,t,i,r){if(r&&!global.authen.isAuthenticated()){global.showModalNotAuthorize();return}var u="/HtmlTemplate?name="+n;t&&t!=""&&(u+="&"+t);common.ui.showLoading();$.get(u,function(n){common.ui.modal.show("commonModal",i,n);AngularHelper.Compile($("#commonModal .modal-body"));common.ui.hideLoading()})}function generateUUID(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&3|8).toString(16)})}function showGmapPopup(n,t,i,r){common.ui.modal.show("gmapModal");$("#gmap-loading").show();$("#map-iframe-container").html('<iframe id="gmap-iframe" name="hs1481909079189" frameborder="0" key="0" frameborder="0" style="overflow:hidden;height:360px;width:100%" height="460" width="100%" src="/showmap.html?lat='+t+"&lng="+i+"&title="+r+'"><\/iframe>');$("#gmap-iframe").load(function(){$("#gmap-loading").hide()})}function calcuateTimeAgo(n){var u=n,r,t;if(n==null||n==undefined)return"";switch(typeof n){case"number":break;case"string":n=+new Date(n);break;case"object":n.constructor===Date&&(n=n.getTime());break;default:n=+new Date}var f=[[60,"giây",1],[120,"1 phút trước","1 phút trước"],[3600,"phút",60],[7200,"1 giờ trước","1 giờ trước"],[86400,"giờ",3600],[172800,"Hôm qua","Sáng mai"],[604800,"ngày",86400],[1209600,"Tuần trước","Tuần tới"],[2419200,"Tuần",604800],[4838400,"Tháng trước","Tháng tới"],[29030400,"tháng",2419200],[58060800,"Năm trước","Năm tới"],[290304e4,"năm",29030400],[580608e4,"Last century","Next century"],[580608e5,"centuries",290304e4]],i=(+new Date-n)/1e3;if(i==0)return"Vừa xong";if(i<0)return DisplayNormalDateTime(u);for(r=0;t=f[r++];)if(i<t[0])return typeof t[2]=="string"?t[1]:Math.floor(i/t[2])+" "+t[1]+" trước";return n}function DisplayNormalDateTime(n){var t=null;switch(typeof n){case"number":break;case"string":t=new Date(n);break;case"object":n.constructor===Date&&(t=n.getTime());break;default:t=new Date}var e=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),u=t.getHours(),f=t.getMinutes();return u+"h "+f+" phút, ngày "+r+"/"+i}var common,alertNotification,global,formValid;document.addEventListener("DOMContentLoaded",function(){if(!Notification){alert("Desktop notifications not available in your browser. Try Chromium.");return}Notification.permission!=="granted"&&Notification.requestPermission()});$(function(){$("body").tooltip({selector:'[data-toggle="tooltip"]'});$("#commonModal .modal-content").draggable({handle:".modal-header"});$(".modal-link-angularjs").click(function(){showAngularJsModalByBtn(this)});$(".input-comment").click(function(){console.log("Trigger bat doi");$(this).closest(".item-card").find(".btn-batdoi").trigger("click")});$(".timer-countdown").each(function(){var n=this;startTimer(parseFloat($(this).html())*60,$(this),function(){console.log("Timer is ended");$(n).closest(".waiting-text").html("Đối không trả lời sau 45 phút")})});$.ajaxSetup({beforeSend:function(){common.ui.showLoading()},complete:function(){common.ui.hideLoading()},success:function(){common.ui.hideLoading()},error:function(){common.ui.hideLoading()}})});common={config:{userId:"",xAuthToken:"",serviceDomain:"https://www.timdoinhanh.com",webDomain:"https://www.timdoinhanh.com",currentDefaultPage:"",pageUrl:"",myTeams:{},role:{Leader:2,ViceLeader:4,StadiumManager:5,Memerber:6},notificationItemType:{matchRecipient_PartnerCreate:1,matchRecipient_PartnerCancel:4,matchRecipient_OwnerCancel:2,matchRecipient_OwnerConfirm:3,requestApproveBooking:8,responseApproveBooking:9,requestApproveRepeatBooking:10,responseApproveRepeatBooking:11},matchRecipientStatuss:[{id:1,name:"Chờ xác nhận"},{id:7,name:"Đồng ý"},{id:6,name:"Từ chối"}]},user:{},ui:{showLoading:function(){$("#loadingBar").removeClass("hidden")},hideLoading:function(){setTimeout(function(){$("#loadingBar").addClass("hidden")},500)},modal:{show:function(n,t,i){setTimeout(function(){$("#"+n).modal("show");var r=$("#"+n);t&&r.find(".modal-title").html(t);i&&r.find(".modal-body").html(i)},50)},hide:function(n){$("#"+n).find("button.close")[0].click()},showConfirm:function(n,t){$("#layout_modal_info").find(".modal-content-info").html(n);$("#layout_modal_info").find(".confirm-yes").attr("ng-click",t);common.ui.modal.show("layout_modal_info")},showInfo:function(n,t){$("#layout_modal_info").find(".modal-content-info").html(t);$("#layout_modal_info").find(".modal-title").html(n);common.ui.modal.show("layout_modal_info")}},notification:{showMessage:function(n,t,i){$.notify({title:n,message:t,target:"_blank"},{element:"body",position:null,type:i,allow_dismiss:!0,newest_on_top:!1,showProgressbar:!1,placement:{from:"top",align:"right"},offset:20,spacing:10,z_index:1031,delay:5e3,timer:1e3,url_target:"_blank",mouse_over:null,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},onShow:null,onShown:null,onClose:null,onClosed:null,icon_type:"class",template:'<div style="z-index:9999999 !important;" data-notify="container1" class="col-xs-11 col-sm-3 alert alert-{0}" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">×<\/button><span data-notify="icon"><\/span> <span data-notify="title">{1}<\/span> <span data-notify="message">{2}<\/span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"><\/div><\/div><a href="{3}" target="{4}" data-notify="url"><\/a><\/div>'})},success:function(n){this.showMessage("Thông báo!",n,"success")},error:function(n){this.showMessage("Lỗi!",n,"danger")},warning:function(n){this.showMessage("Cảnh báo!",n,"warning")}}},convertStringViToEn:function(n){var i=["aAeEoOuUiIdDyY","áàạảãâấầậẩẫăắằặẳẵ","ÁÀẠẢÃÂẤẦẬẨẪĂẮẰẶẲẴ","éèẹẻẽêếềệểễ","ÉÈẸẺẼÊẾỀỆỂỄ","óòọỏõôốồộổỗơớờợởỡ","ÓÒỌỎÕÔỐỒỘỔỖƠỚỜỢỞỠ","úùụủũưứừựửữ","ÚÙỤỦŨƯỨỪỰỬỮ","íìịỉĩ","ÍÌỊỈĨ","đ","Đ","ýỳỵỷỹ","ÝỲỴỶỸ"],t,r;if(n.length=0)return"";for(t=1;t<i.length;t++)for(r=0;r<i[t].length;r++)n=n.replaceAll(i[t][r],i[0][t-1]);return n},convertToFriendly:function(n){return common.convertStringViToEn(n).replaceAll("/"," ").replaceAll("&","|").replaceAll(" ","-").replaceAll("--","-").replaceAll(".","").toLowerCase()},func:{getChannelID:function(n,t){if(n==undefined||t==undefined)return"channel_error";var i=0,r=0;return(i=$.isNumeric(n)?n:parseInt(n.replace("usr-","")),r=$.isNumeric(t)?t:parseInt(t.replace("usr-","")),i<r)?i+"_"+r:r+"_"+i},getGuestUserId:function(n,t){var i=n.toString();return($.isNumeric(n)||(i=parseInt(n.replace("usr-",""))),t.indexOf(i+"_")>=0)?"usr-"+t.replace(i+"_",""):t.indexOf("_"+i)>=0?"usr-"+t.replace("_"+i,""):null},isActiveObj:function(n){return n!=undefined&&n!=null&&n.length>0},angularApply:function(n,t){var i=n.$$phase;i!="$apply"&&i!="$digest"?n.$apply(function(){t()}):t()},parseFireObject:function(n){for(var u,f,i=[],r=Object.keys(n),t=0;t<r.length;t++)u=n[r[t]],f=jQuery.extend(!0,{},u),i.push(f);return i},convertFireObjectToArrayString:function(n){var r=[],i,t,u;if(n!=undefined&&n!=null)for(i=Object.keys(n),t=0;t<i.length;t++)u=n[i[t]],r.push(u);return r},isMobile:{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return common.func.isMobile.Android()||common.func.isMobile.BlackBerry()||common.func.isMobile.iOS()||common.func.isMobile.Opera()||common.func.isMobile.Windows()}},getUTCTime:function(){var n=new Date;return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())}}};alertNotification=function(n){if(!Notification){alert("Desktop notifications not available in your browser. Try Chromium.");return}if(Notification.permission!=="granted")Notification.requestPermission();else var t=new Notification("Thông báo!",{icon:"/Assets/Img/Favicons/favicon-32x32.png",body:n})};String.prototype.replaceAll=function(n,t){for(var i=this;i.indexOf(n)>=0;)i=i.replace(n,t);return i};$.fn.modal.prototype.constructor.Constructor.DEFAULTS.backdrop="static";global={modalMatchFindingRequest:{show:function(){common.ui.modal.show("modalMatchFindingRequest_Create")},hide:function(){common.ui.modal.hide("modalMatchFindingRequest_Create")}},showModalNotAuthorize:function(){common.ui.modal.show("modalNotAuthorize")},showModalLoginPopup:function(){common.ui.modal.show("loginModal")},authen:{isAuthenticated:function(){return common.config.xAuthToken!=null&&common.config.xAuthToken!=undefined&&common.config.xAuthToken.length>0},getUserID:function(){return global.authen.isAuthenticated()?common.config.userId:null}}};formValid=function(n){var i=$("#"+n),r=i.hasClass("ng-valid"),t;return r||(t=i.find(".ng-invalid").first(),t!=undefined&&(t.focus(),t.addClass("element-checked"))),r};String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};Array.prototype.findWhere=function(n,t){var i=this,r;if(i==undefined||i==null||i.length==0)return null;for(r=0;r<i.length;r++)if(i[r][n]===t)return i[r];return null};Array.prototype.contains=function(n){var t=this,i;if(t==undefined||t==null||t.length==0)return!1;for(i=0;i<t.length;i++)if(t[i]==n)return!0;return!1};navigator.sayswho=function(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],"IE "+(t[1]||"")):n[1]==="Chrome"&&(t=i.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),n.join(" "))}();sportApp.config(["$httpProvider","$routeProvider",function(n,t){n.interceptors.push("httpRequestInterceptor");n.defaults.headers.get={};n.defaults.headers.get["Content-Type"]="application/json; charset=utf-8";n.defaults.headers.common["X-Auth-Token"]=common.config.xAuthToken;t.when("/users",{templateUrl:"team-user.html",controller:"TeamUserCtrl as vm"}).when("/gallery",{templateUrl:"gallery.html",controller:"TeamGalleryCtrl"}).when("/setting",{templateUrl:"setting.html",controller:"TeamSettingCtrl as vm"}).when("/newteam",{templateUrl:"setting.html",controller:"TeamSettingCtrl as vm"}).when("/fundmanagement",{templateUrl:"fundmanagement.html",controller:"TeamFundManagementCtrl"}).when("/match-settings",{templateUrl:"matchSettings.html",controller:"MatchSettingsCtrl"}).when("/filterMatchFinding",{templateUrl:"matchFindingSearch.html",controller:"matchFindingCtrl"}).when("/stadium",{templateUrl:"stadiumList.html",controller:"stadiumCtrl"}).when("/booking",{templateUrl:"bookingRequests.html",controller:"stadiumCtrl"}).when("/stadium-info/:stadiumId/:isSuccess",{templateUrl:"stadiumInfo.html",controller:"stadiumInfoCtrl"}).when("/stadium-info/:stadiumId",{templateUrl:"stadiumInfo.html",controller:"stadiumInfoCtrl"}).when("/stadium-prices/:stadiumId",{templateUrl:"stadiumPrices.html",controller:"StadiumPriceManagementCtrl as vm"}).when("/addNew/:typeId",{templateUrl:"stadiumInfo.html",controller:"stadiumInfoCtrl"}).when("/bookingManager/:stadiumId",{templateUrl:"bookingManager.html",controller:"StadiumBookingManager"});t.otherwise({redirectTo:common.config.currentDefaultPage})}]).run(["$rootScope","$location","CommonService","MatchFindingService","StadiumService","CalendarService","FireUserService",function(n,t,i,r,u,f,e){function o(t){return n.userMatchList.filter(function(n){return n.calendarId==t})[0]}function s(){n.showMDSuccessMessage=!1;n.showMDErrorssage=!1}function h(t){n.showMDSuccessMessage=t;n.showMDErrorssage=!t}n.matchFindingCreationErrors="";n.myTeams=common.config.myTeams;n.getMyLeadTeams=function(){return n.myTeams};n.firstTeamUrl=function(){var t=n.myTeams,i;return t!=null&&t!=undefined&&t.length>0?(i=t[0],"/team/view/"+i.id):"/team/management"};n.totalNotification=5;n.stadiumsCount=0;n.footballTeamsCount=0;n.matchFindingQueuesCount=0;n.stadiumBookingsCount=0;n.matchFindingRequest={};n.matchFindingRequest.contract="";n.matchFindingRequest.message="";n.matchFindingRequest.typeId=1;n.matchFindingRequest.countryId=1;n.matchFindingRequest.provinceId="3";n.matchFindingRequest.ageGroupIds=[];n.matchFindingRequest.countyId=null;n.matchFindingRequest.stadiumIds=[];n.matchFindingRequest.levelIds=[];n.matchFindingRequest.startTime=null;n.matchFindingRequest.endTime=null;n.listNumberOfWeeksRepeat=[{id:0,name:"Không lặp"},{id:1,name:"1 Tuần"},{id:2,name:"2 Tuần"},{id:3,name:"3 Tuần"},{id:4,name:"4 Tuần"},{id:5,name:"5 Tuần"},{id:6,name:"6 Tuần"},{id:7,name:"7 Tuần"},{id:8,name:"8 Tuần"},{id:9,name:"9 Tuần"},{id:10,name:"10 Tuần"}];n.listAgeGroups=[];n.listLevels=[];n.listProvinces=[];n.listCounties=[];n.listStadiums=[];n.listStadiumNumbers=[];n.hasStadium=!0;n.loadMatchFindingRequest=function(){commonData.allAgeGroup!=null&&commonData.allAgeGroup.length>0?n.listAgeGroups=commonData.allAgeGroup:i.getAllCommonItems("agegroup").then(function(t){n.listAgeGroups=t.records;commonData.allAgeGroup=t.records});commonData.allLevel!=null&&commonData.allLevel.length>0?n.listLevels=commonData.allLevel:i.getAllCommonItems("level").then(function(t){n.listLevels=t.records;commonData.allLevel=t.records});commonData.allProvinces!=null&&commonData.allProvinces.length>0?n.listProvinces=commonData.allProvinces:i.getAllProvinces(n.matchFindingRequest.countryId).then(function(t){n.listProvinces=t.records;commonData.allProvinces=t.records});n.loadCounties(n.matchFindingRequest.provinceId);n.loadStadiums()};n.loadCounties=function(t){i.getAllCounties(t).then(function(t){n.listCounties=t.records})};n.loadStadiums=function(){var t=n.matchFindingRequest.countyId!=null?[n.matchFindingRequest.countyId]:[],i={provinceId:n.matchFindingRequest.provinceId,key:"",countyIdList:t,sportType:n.matchFindingRequest.typeId};u.searchStadiums(i).then(function(t){n.listStadiums=t.records;t.RepeatStadiumId!=null&&t.RepeatStadiumId>0?n.matchFindingRequest.stadiumId=t.RepeatStadiumId:t.records!=null&&t.records.length>0&&(n.matchFindingRequest.stadiumId=t.records[0].id)})};n.loadStadiumNumbers=function(){var t=n.matchFindingRequest.stadiumId,i={stadiumId:t};u.searchStadiumNumbers(i).then(function(t){n.listStadiumNumbers=t.records})};n.onShowModalMatchFindingRequest=function(){if(!global.authen.isAuthenticated()){global.showModalNotAuthorize();return}if(n.$$childHead!=null&&n.$$childHead.filter!=undefined){var t=n.$$childHead.filter;n.matchFindingRequest=jQuery.extend({},t);n.matchFindingRequest.countyIds.length>0&&(n.matchFindingRequest.countyId=n.matchFindingRequest.countyIds[0])}n.loadMatchFindingRequest();global.modalMatchFindingRequest.show()};n.showAdvance=!1;n.toggleAdvance=function(){n.showAdvance=n.showAdvance?!1:!0};common.user.matches&&(n.userMatchList=common.user.matches,n.selectedMatch=common.user.matches[0]);n.showConfirmAttendance=function(t){s();n.selectedMatch=o(t);common.ui.modal.show("modalMatchConfirmAttendance")};n.confirmAttendance=function(t){s();var i=n.selectedMatch;if(i.teamA.confirmStatus===0){alert("Bạn vui lòng xác nhận CÓ hoặc KHÔNG tham gia trận này.");return}common.ui.showLoading();$(t.toElement).button("loading");f.confirmAttendance(i.calendarId,i.teamA.confirmStatus,i.teamA.confirmNotes).then(function(r){r.isSuccessful&&(n.userMatchList=r.data,n.selectedMatch=o(i.calendarId));common.ui.hideLoading();h(r.isSuccessful);$(t.toElement).button("reset")})};n.showModalGmapMap=function(n,t,i,r){common.ui.modal.show("modalMatchConfirmAttendance");var u=new google.maps.LatLng(t,i),f={zoom:14,center:u,mapTypeId:google.maps.MapTypeId.ROADMAP},e=new google.maps.Map(document.getElementById("canvasId"),f),o=new google.maps.Marker({position:u,map:e,title:r})};n.currentUser={};n.getCurrentUser=function(){var t=(new firebase.database).ref("fireChat/users/"+common.config.userId);t.on("value",function(t){var i=t.val(),r;if(i!=null)r=n.$$phase,r!="$apply"&&r!="$digest"?n.$apply(function(){n.currentUser=i}):n.currentUser=i;else{var f={id:common.config.userId,avatar:common.config.avatar,name:common.config.name,status:1,currentChannels:[]},e=(new firebase.database).ref("fireChat/users"),o=common.config.userId,u={};u[o]=f;e.update(u)}})};n.parseFireObject=function(n){for(var u,f,i=[],r=Object.keys(n),t=0;t<r.length;t++)u=n[r[t]],f=jQuery.extend(!0,{},u),i.push(f);return i};global.authen.isAuthenticated()&&n.getCurrentUser();$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();$("#modalSltProvince").change(function(){var t=$(this).val();n.matchFindingRequest.stadiumId=0;n.matchFindingRequest.stadiumNumberId=0;n.listStadiumNumbers=[];$('[idd="modalSltStadium"]').html("");$('[idd="modalSltStadiumNumber"]').html("");n.loadCounties(t);n.loadStadiums();n.loadStadiumNumbers()});$("#modalSltCounty").change(function(){n.listStadiumNumbers=[];var t=$(this).val();n.matchFindingRequest.stadiumId=0;n.matchFindingRequest.stadiumNumberId=0;n.listStadiumNumbers=[];$('[idd="modalSltStadium"]').html("");$('[idd="modalSltStadiumNumber"]').html("");n.loadStadiums();n.loadStadiumNumbers()});$("#modalSltStadium").change(function(){n.loadStadiumNumbers()});setTimeout(function(){$(".chat-nhanh").attr("title","Click để chat nhanh với đối.");$(".chat-nhanh").each(function(){var t=$(this).parent().attr("owner-id");n.pullClassUserStatus(t)})},500)});n.getMatchFindingUrl=function(n){return common.config.webDomain+"match/confirmation/"+n};n.getReviewBookingListingUrl=function(n){return common.config.webDomain+"stadium/bookingreview/"+n};n.getBookingHistoryListingUrl=function(n,t){return common.config.webDomain+"stadium/bookinghistory?nid="+n+"&type="+t};n.getMatchFindingOnPageUrl=function(n){return common.config.webDomain+"match/"+n};n.getTeamUrl=function(n,t){var i=common.convertToFriendly(n);return common.config.webDomain+"team/management?id="+t};n.newTeamUrl=function(){return common.config.webDomain+"team/management#/newteam"};n.getImageOrDefaut=function(n){return(n==null||n==undefined||n.length==0)&&(n="/Assets/img/default-img.jpg"),n};n.getImageOrDefautTeam=function(n){return(n==null||n==undefined||n.length==0)&&(n="/Assets/img/default-img.jpg"),n};n.inArray=function(n,t){return-1!==t.indexOf(n)};n.timeFromNow=function(n){return calcuateTimeAgo(n)};n.pullClassUserStatus=function(n){var t=n.indexOf("usr-")>=0?n:"usr-"+n;e.getCurrentUser(t).then(function(n){var r=n.id.toString().indexOf("usr-")>=0?n.id.replace("usr-",""):n.id,i=$('.captain-item[owner-id="'+r+'"], .user-online-status-container[owner-id="'+r+'"]'),t;common.func.isActiveObj(i)&&(t=i.find(".captain-item-status, .user-online-status"),n.status==1?(t.removeClass("offline"),t.addClass("online")):(t.removeClass("online"),t.addClass("offline"),i.find(".chat-nhanh").addClass("chat-nhanh-offline")))})};n.onQuickChat=function(t){if(!global.authen.isAuthenticated()){global.showModalNotAuthorize();return}common.func.isActiveObj($("#guestUserId_Chatting"))&&($("#guestUserId_Chatting").val(t),common.func.angularApply(n,function(){n.$broadcast("rootscope_onGoToChatting",{})}))}}]);angular.module("sportApp").filter("to_trusted",["$sce",function(n){return function(t){return n.trustAsHtml(t)}}]);sportApp.factory("alert",["$uibModal",function(n){function t(t,i){return n.open({templateUrl:"modalContent.html",controller:function(){var n=this;n.action=t;n.event=i},controllerAs:"vm"})}return{show:t}}])